import*as n from"@minecraft/server";import*as G from"@minecraft/server";import*as K from"@minecraft/server-ui";var O=Object.defineProperty,y=(e,t)=>{for(var r in t)O(e,r,{get:t[r],enumerable:!0})},$={};y($,{config:()=>k,default:()=>Q,events:()=>T,plugins:()=>H,util:()=>E,version:()=>A});var k={};y(k,{Config:()=>L,default:()=>R});var L=class{constructor(e){this._data=e}get(e){return this._data[e]}set(e,t){return this._data[e]=t}has(e){return e in this._data}delete(e){return delete this._data[e]}},M=new L({debug:!0}),R=M,E={};y(E,{debug:()=>W,normalizePath:()=>U,resolvePath:()=>X});function W(...e){k.default.get("debug")&&console.warn("[creators-api]",...e)}function U(e){let t=[];for(let r of e.split("/"))if(!(!r.length||r==".")){if(r==".."){t.pop();continue}t.push(r)}return t.filter(r=>r.length).join("/")}function X(e,t,r){if(t[0]=="/")return U(t);let i=U(e).split("/");r&&i.pop();for(let a of t.split("/"))if(!(!a.length||a==".")){if(a==".."){i.pop();continue}i.push(a)}return i.filter(a=>a.length).join("/")}var H={};y(H,{Expression:()=>z,Loader:()=>C,Module:()=>B,Plugin:()=>N,Version:()=>I,global:()=>D});var J=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;function w(e,t){if(!e.length&&!t.length)return 0;if(!e.length)return-1;if(!t.length)return 1;let r=Math.max(e.length,t.length);for(let i=0;i<r;i++){let a=e[i],c=t[i];if(typeof a>"u")return 1;if(typeof c>"u")return-1;let o=typeof a=="number",l=typeof c=="number";if(o&&!l)return 1;if(!o&&l)return-1;if(e<t)return 1;if(e>t)return-1}return 0}var I=class{constructor(e){e=e.trim();let t=e.match(J);if(!t)throw`unexpected version string: ${e}`;if(this.major=+t[1],this.minor=+t[2],this.patch=+t[3],isNaN(this.major)||isNaN(this.minor)||isNaN(this.patch))throw"major.minor.patch must be a number";this.pre=t[4]?.split(".").map(r=>{let i=+r;return typeof i=="number"&&i>=0?i:r})||[],this.build=t[5]?.split(".")||[]}gt(e){return this.major>e.major||this.major==e.major&&this.minor>e.minor||this.major==e.major&&this.minor==e.minor&&this.patch>e.patch||this.major==e.major&&this.minor==e.minor&&this.patch==e.patch&&w(this.pre,e.pre)==-1}lt(e){return this.major<e.major||this.major==e.major&&this.minor<e.minor||this.major==e.major&&this.minor==e.minor&&this.patch<e.patch||this.major==e.major&&this.minor==e.minor&&this.patch==e.patch&&w(this.pre,e.pre)==1}eq(e){return this.major==e.major&&this.minor==e.minor&&this.patch==e.patch&&w(this.pre,e.pre)==0}gte(e){return this.gt(e)||this.eq(e)}lte(e){return this.lt(e)||this.eq(e)}toString(){let e=`${this.major}.${this.minor}.${this.patch}`;return this.pre.length&&(e+="-"+this.pre.join(".")),this.build.length&&(e+="+"+this.build.join(".")),e}},V=/^([*0xX]|[1-9]\d*)(?:\.([*0xX]|[1-9]\d*)(?:\.([*0xX]|[1-9]\d*))?)?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,z=class{constructor(e){let t=[];for(let r of e.split("||")){let i=r.trim().split(/\s+/),a=[];for(let c=0;c<i.length;c++){let o=i[c],l,d=0,g,v;if((g=o[0]=="^")||(v=o[0]=="~")?o=o.slice(1):(o[0]==">"?(d=-1,o=o.slice(1)):o[0]=="<"&&(d=1,o=o.slice(1)),o[0]=="="&&(l=!0,o=o.slice(1))),!o.length){if(c==i.length-1)throw"subject version not provided";c++,o=i[c]}let j=o.match(V);if(!j)throw`invalid version expression: ${o}`;let h=+j[1],x;isNaN(h)&&(x=!(h=null));let f=+j[2],_;isNaN(f)&&(_=!(f=null));let b=+j[3],P;isNaN(b)&&(P=!(b=null));let Z=j[4]?.split(".").map(p=>{let u=+p;return typeof u=="number"&&u>=0?u:p})||[];if(v){if(x)continue;let p,u,m;_?(p=h+1,u=f=0,m=b=0):P?(p=h,u=f+1,m=b=0):(p=h,u=f+1,m=0),a.push({maxrange:!0,equal:!1,compare:1,major:p,minor:u,patch:m,pre:[0]})}else if(g){if(x)continue;let p,u,m;_?(p=h+1,u=f=0,m=b=0):P?(p=h==0?h:h+1,u=h!=0?0:f+1,m=b=0):(p=h==0?0:h+1,u=h==0?f==0?f:f+1:0,m=h==0&&f==0?b+1:0),a.push({maxrange:!0,equal:!1,compare:1,major:p,minor:u,patch:m,pre:[0]})}!l&&d==0&&(x||_||P)&&(d=-1),a.push({equal:l||d==0||g||v,compare:g||v?-1:d,major:h,minor:f,patch:b,pre:Z})}t.push(a)}this._compiled=t,this._expr=e.split(/\s+/).join(" ")}test(e){for(let t of this._compiled){let r=!0;for(let i of t){let a=!1,c=typeof i.major!="number"||e.major==i.major,o=typeof i.minor!="number"||e.minor==i.minor,l=typeof i.patch!="number"||e.patch==i.patch,d=c&&o&&l;if(i.equal&&(a=d&&w(i.pre,e.pre)==0),!a&&(i.maxrange||!e.pre.length||i.pre.length&&d)&&(i.compare==-1?a=e.major>i.major||c&&e.minor>i.minor||c&&o&&e.patch>i.patch||c&&o&&l&&w(e.pre,i.pre)==-1:i.compare==1&&(a=e.major<i.major||c&&e.minor<i.minor||c&&o&&e.patch<i.patch||c&&o&&l&&w(e.pre,i.pre)==1)),!a){r=!1;break}}if(r)return r}return!1}latest(e){e=e.filter(r=>this.test(r));let t=e[0];for(let r of e.slice(1))r.gt(t)&&(t=r);return t}oldest(e){e=e.filter(r=>this.test(r));let t=e[0];for(let r of e.slice(1))r.lt(t)&&(t=r);return t}toString(){return this._expr}},D=globalThis,B=class{constructor(e,t,r){this.exports={},this._loaded=!1,this._ran=!1,this.children=[],this.loader=t,this.action=r,this.path=E.normalizePath(e);let i=e.split("/");this.filename=i[i.length-1],this.require=a=>{let c=E.resolvePath(this.path,a,!0),o=[c,c+".js",c+"/index.js"],l;for(let d of o){if(!(l=t.modules[d])){l=t.modules[d];continue}break}if(!l&&!/^.{0,2}\//.test(a)){a=E.normalizePath(a);let d=a.split("/",1)[0],g=a.slice(d.length+1),v=t.libs[d];g.length?l=v?.loader.modules[g]:l=v?.loader.modules[v.entry]}if(!l)throw`Couldn't resolve module specifier: ${a}`;return this.children.includes(l)||this.children.push(l),l.run()}}get loaded(){return this._loaded}get ran(){return this._ran}run(){return this._ran||(this._ran=!0,this.action.call(this.loader.plugin,this.loader.intent,this.require,this,this.exports,D),this._loaded=!0),this.exports}reset(){if(this._ran){if(!this._loaded)throw"Illegal invocation";this.exports={},this._ran=!1,this._loaded=!1,this.children=[]}}},C=class{constructor(e,t){this.plugin=e,this.modules={};for(let r in t)this.modules[r]=new B(r,this,t[r])}start(e,t){this.libs=e,this.intent=t,this._running=!0;let r=this.modules[this.plugin.entry].run();return this._loaded=!0,r}reset(){if(this._running){if(!this._loaded)throw"Modules failed to terminate";this.libs={},this.intent=[];for(let e in this.modules)this.modules[e].reset()}}},S={},N=class{constructor(e,t){this.manifest=e,this.id=e.id,this.name=e.name||this.id,this.version=new I(e.version),this.engine=new z(e.engine||">=*-0"),this.entry=e.entry?E.normalizePath(e.entry):"index.js",this.dependencies={};for(let r in e.dependencies||{})this.dependencies[r]=new z(e.dependencies[r]);this.loader=new C(this,t)}register(){if(!this.engine.test(A))throw E.debug(`Plugin "${this.name}" (${this.id}) failed to install with errors`),E.debug(`Plugin "${this.id}" requires Creators\u2019 API engine version '${this.engine}' but ${A} were installed`),`incompatible api version: ${A}`;return(S[this.id]||(S[this.id]=[])).push(this),this}start(...e){let t={};for(let r in this.dependencies){let i=this.dependencies[r],a=S[r];if(!a)throw`Plugin '${this.id}' dependencies an unknown lib '${r}'. Do you installed the lib?`;let c=[];a.forEach(l=>c.push(l.version));let o=i.latest(c);if(!o)throw`Plugin '${this.id}' dependencies an unknown version of lib '${r}': ${i}`;t[r]=a.find(l=>l.version.eq(o))}return this.loader.start(t,e||[])}stop(){return this.loader.reset(),this}},T={};y(T,{Events:()=>q,main:()=>F});var s=new q;n.world.beforeEvents.chatSend.subscribe(e=>s.dispatchEvent("beforeChatSend",e));n.world.beforeEvents.dataDrivenEntityTriggerEvent.subscribe(e=>s.dispatchEvent("beforeDataDrivenEntityTrigger",e));n.world.beforeEvents.explosion.subscribe(e=>s.dispatchEvent("beforeExplosion",e));n.world.beforeEvents.itemDefinitionEvent.subscribe(e=>s.dispatchEvent("beforeItemDefinition",e));n.world.beforeEvents.itemUse.subscribe(e=>s.dispatchEvent("beforeItemUse",e));n.world.beforeEvents.itemUseOn.subscribe(e=>s.dispatchEvent("beforeItemUseOn",e));n.world.beforeEvents.pistonActivate.subscribe(e=>s.dispatchEvent("beforePistonActivate",e));n.world.afterEvents.blockBreak.subscribe(e=>s.dispatchEvent("afterBlockBreak",e));n.world.afterEvents.blockExplode.subscribe(e=>s.dispatchEvent("afterBlockExplode",e));n.world.afterEvents.blockPlace.subscribe(e=>s.dispatchEvent("afterBlockPlace",e));n.world.afterEvents.buttonPush.subscribe(e=>s.dispatchEvent("afterButtonPush",e));n.world.afterEvents.chatSend.subscribe(e=>s.dispatchEvent("afterChatSend",e));n.world.afterEvents.dataDrivenEntityTriggerEvent.subscribe(e=>s.dispatchEvent("afterDataDrivenEntityTrigger",e));n.world.afterEvents.effectAdd.subscribe(e=>s.dispatchEvent("afterEffectAdd",e));n.world.afterEvents.entityDie.subscribe(e=>s.dispatchEvent("afterEntityDie",e));n.world.afterEvents.entityHealthChanged.subscribe(e=>s.dispatchEvent("afterEntityHealthChanged",e));n.world.afterEvents.entityHitBlock.subscribe(e=>s.dispatchEvent("afterEntityHitBlock",e));n.world.afterEvents.entityHitEntity.subscribe(e=>s.dispatchEvent("afterEntityHitEntity",e));n.world.afterEvents.entityHurt.subscribe(e=>s.dispatchEvent("afterEntityHurt",e));n.world.afterEvents.entityRemoved.subscribe(e=>s.dispatchEvent("afterEntityRemoved",e));n.world.afterEvents.entitySpawn.subscribe(e=>s.dispatchEvent("afterEntitySpawn",e));n.world.afterEvents.explosion.subscribe(e=>s.dispatchEvent("afterExplosion",e));n.world.afterEvents.itemCompleteUse.subscribe(e=>s.dispatchEvent("afterItemCompleteUse",e));n.world.afterEvents.itemDefinitionEvent.subscribe(e=>s.dispatchEvent("afterItemDefinition",e));n.world.afterEvents.itemReleaseUse.subscribe(e=>s.dispatchEvent("afterItemReleaseUse",e));n.world.afterEvents.itemStartUse.subscribe(e=>s.dispatchEvent("afterItemStartUse",e));n.world.afterEvents.itemStartUseOn.subscribe(e=>s.dispatchEvent("afterItemStartUseOn",e));n.world.afterEvents.itemStopUse.subscribe(e=>s.dispatchEvent("afterItemStopUse",e));n.world.afterEvents.itemStopUseOn.subscribe(e=>s.dispatchEvent("afterItemStopUseOn",e));n.world.afterEvents.itemUse.subscribe(e=>s.dispatchEvent("afterItemUse",e));n.world.afterEvents.itemUseOn.subscribe(e=>s.dispatchEvent("afterItemUseOn",e));n.world.afterEvents.leverAction.subscribe(e=>s.dispatchEvent("afterLeverAction",e));n.world.afterEvents.messageReceive.subscribe(e=>s.dispatchEvent("afterMessageReceive",e));n.world.afterEvents.pistonActivate.subscribe(e=>s.dispatchEvent("afterPistonActivate",e));n.world.afterEvents.playerJoin.subscribe(e=>s.dispatchEvent("afterPlayerJoin",e));n.world.afterEvents.playerLeave.subscribe(e=>s.dispatchEvent("afterPlayerLeave",e));n.world.afterEvents.playerSpawn.subscribe(e=>s.dispatchEvent("afterPlayerSpawn",e));n.world.afterEvents.pressurePlatePop.subscribe(e=>s.dispatchEvent("afterPressurePlatePop",e));n.world.afterEvents.pressurePlatePush.subscribe(e=>s.dispatchEvent("afterPressurePlatePush",e));n.world.afterEvents.projectileHitBlock.subscribe(e=>s.dispatchEvent("afterProjectileHitBlock",e));n.world.afterEvents.projectileHitEntity.subscribe(e=>s.dispatchEvent("afterProjectileHitEntity",e));n.world.afterEvents.targetBlockHit.subscribe(e=>s.dispatchEvent("afterTargetBlockHit",e));n.world.afterEvents.tripWireTrip.subscribe(e=>s.dispatchEvent("afterTripWireTrip",e));n.world.afterEvents.weatherChange.subscribe(e=>s.dispatchEvent("afterWeatherChange",e));n.world.afterEvents.worldInitialize.subscribe(e=>s.dispatchEvent("afterWorldInitialize",e));n.system.beforeEvents.watchdogTerminate.subscribe(e=>s.dispatchEvent("beforeWatchdogTerminate",e));n.system.afterEvents.scriptEventReceive.subscribe(e=>s.dispatchEvent("afterScriptEventReceive",e));var q=class{constructor(){this._listeners=[],this._guid=0}addEventListener(e,t,r){let i={event:e,listener:t,once:r?.once,id:++this._guid};return r?.prepend?this._listeners.unshift(i):this._listeners.push(i),i.id}removeEventListener(e){let t=this._listeners.findIndex(r=>r.id==e);return t==-1?!1:(this._listeners.splice(t,1),!0)}dispatchEvent(e,...t){for(let r of this._listeners)if(r.event==e){try{r.listener.call(this,...t)}catch{}r.once&&this.removeEventListener(r.id)}}on(e,t){return this.addEventListener(e,t)}once(e,t){return this.addEventListener(e,t,{once:!0})}prependListener(e,t){return this.addEventListener(e,t,{prepend:!0})}prependOnceListener(e,t){return this.addEventListener(e,t,{once:!0,prepend:!0})}off(e){return this.removeEventListener(e)}},F=s;new N({id:"events",version:"1.0.0"},{"index.js":(e,t,r,i)=>{i.Events=q,i.main=s},"minecraft.js":(e,t,r,i)=>{i.handler=s}}).register();new N({id:"@minecraft",version:"1.0.0",name:"Minecraft Scripts",engine:"*",author:"Minecraft"},{"index.js":(e,t,r,i)=>{i.server=t("./server"),i["server-ui"]=t("./server-ui")},"server/index.js":(e,t,r)=>{r.exports=G},"server-ui/index.js":(e,t,r)=>{r.exports=K}}).register();var A=new I("0.2.0"),Q=$;globalThis.creator=$;export{k as config,Q as default,T as events,H as plugins,E as util,A as version};
